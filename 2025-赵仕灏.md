# 2025-赵仕灏
-----------------------------------------------------
## 2025年11月3日 赵仕灏
### 学习进度
1. 更改模型为简化版的双边滤波器，在代码中创建了高斯核
    ```python
    def get_gaussian_kernel(sigma, kernel_size=5):
    """创建高斯核"""
    x = torch.arange(kernel_size).float() - kernel_size // 2
    kernel_1d = torch.exp(-x ** 2 / (2 * sigma ** 2))
    kernel_1d = kernel_1d / kernel_1d.sum()
    kernel_2d = kernel_1d.view(1, -1) * kernel_1d.view(-1, 1)
    return kernel_2d
    
    如果想要加速双边滤波计算速度，则要提前计算空间核函数
    def create_spatial_kernel(kernel_size, sigma, device):
    """
    预先计算空间权重核
    """
    half_size = kernel_size // 2
    x = torch.arange(-half_size, half_size + 1, dtype=torch.float32, device=device)
    y = torch.arange(-half_size, half_size + 1, dtype=torch.float32, device=device)
    y_grid, x_grid = torch.meshgrid(y, x, indexing='ij')

    # 计算空间距离的平方
    spatial_dist_sq = x_grid ** 2 + y_grid ** 2

    # 计算空间权重
    spatial_weights = torch.exp(-spatial_dist_sq / (2 * sigma ** 2))

    return spatial_weights.unsqueeze(0).unsqueeze(0)
2. 在训练完成后获得了空间，值域权重可视化图像
![](media/17621378403711/17621382181893.jpg)

### 研究进度
1. 已经完成简化版双边滤波，计算在整个图像进行卷积，算出整体图像的空间权重后应用到强度权重图。

### 下周计划
1. 计划下周完成真正对逐个像素实现双边滤波器。并且完成提前算出空间权重的改进。
2